.. _cve-2022-38337:

:bdg-light:`CVSS N/A` CVE-2022-38337
======================================

.. card::

    :bdg-light:`CVSS N/A`
    ^^^
    When aborting a SFTP connection, MobaXterm before v22.2 sends a hardcoded password to the server.
    The server treats this as an invalid login attempt which can result in a Denial of Service (DoS)
    for the user if services like fail2ban are used.
    +++
    **Affected Software:**

    * MobaXterm < v22.2


Description
-----------

The integrated SFTP client, which is based on `SecureBlackbox <https://www.nsoftware.com/ipworks/ssh/>`_,
uses the hardcoded password ``MobaPasswordCancel`` to abort the login attempt on the server.

Sending a wrong password to the server closes the connection, because of a failed login attempt.

This can result in blocking the user (DoS of the user account), if tools like fail2ban are used.

If the server accepts the login attempt, this can result in an information leak,
because environment variables and other information are sent to the server.

This vulnerability was discovered by **AUT-milCERT** during an audit off MobaXterm.

Mitigation
----------

Update MobaXterm to version >= v22.2

Release Notes v22.2
-------------------

* **Bugfix:** when an SFTP session is aborted, the "canceled" password is no more sent to the server


References
----------

* https://mobaxterm.mobatek.net/download-home-edition.html
