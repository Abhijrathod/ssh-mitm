.. _cve-2019-6110:

:fas:`check;sd-text-success` :bdg-warning:`CVSS 6.8` CVE-2019-6110
==================================================================

.. card::

    :bdg-warning:`CVSS 6.8` CVSS:3.0/AV:N/AC:H/PR:N/UI:R/S:U/C:H/I:H/A:N
    ^^^
    In OpenSSH 7.9, due to accepting and displaying arbitrary stderr output from the server,
    a malicious server (or Man-in-The-Middle attacker) can manipulate the client output,
    for example to use ANSI control codes to hide additional files being transferred.
    +++
    **Affected Software:**

    * OpenSSH <= 7.9
    * WinSCP <= 5.13

    :fas:`check;sd-text-success` integrated in `SSH-MITM <https://github.com/ssh-mitm/ssh-mitm/blob/master/sshmitm/plugins/scp/inject_file.py>`_


Test with SSH-MITM
------------------

A proof of concept exploit is integrated in ssh-mitm.

This exploit also integrates :doc:`CVE-2019-6111 </vulnerabilities/CVE-2019-6111>` to inject additional files.

To inject files during a file transfer from the server to the client you have to start
ssh-mitm with following arguments:

.. code-block:: bash

    $ ssh-mitm server --scp-interface inject_file --scp-inject /path/to/additional/file

The file transfer for the injected file will be hidden because of the described
vulnerability and :doc:`CVE-2019-6109 </vulnerabilities/CVE-2019-6109>`.


References
----------

* https://nvd.nist.gov/vuln/detail/CVE-2019-6110
