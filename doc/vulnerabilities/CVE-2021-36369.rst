.. _cve-2021-36369:

:bdg-danger:`CVSS 8.1` CVE-2021-36369
=====================================

.. card::

    :bdg-danger:`CVSS 8.1` CVSS:3.1/AV:L/AC:L/PR:N/UI:R/S:U/C:N/I:N/A:H
    ^^^
    The Dropbear client through 2020.81 proceeds with establishing an SSH session even if it has never sent a substantive authentication response.
    This makes it easier for an attacker-controlled SSH server to present a later spoofed authentication prompt
    (that the attacker can use to capture credential data, and use that data for purposes that are undesired by the client user).
    +++
    **Affected Software:**

    * Dropbear <= 2020.81

    :fas:`check;sd-text-success` integrated in :doc:`SSH-MITM </user_guide/trivialauth>`

PoC Exploit
-----------

The trivial authentication phishing attack is described in :doc:`/user_guide/trivialauth`.

Release Announcement
--------------------

**Dropbear 2022.82**

.. note::

    Added client option "-o DisableTrivialAuth". This can be used to prevent
    the server immediately accepting successful authentication (before any auth
    request) which could cause UI confusion and security issues with agent
    forwarding - it isn't clear which host is prompting to use a key.
    Thanks to Manfred Kaiser from Austrian MilCERT

References
----------

* https://github.com/mkj/dropbear/releases/tag/DROPBEAR_2022.82
* https://github.com/mkj/dropbear/pull/128
