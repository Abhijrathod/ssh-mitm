CVE-2021-36370
==============

.. raw:: html

    <div class="card card-margin">
        <div class="card-header no-border">
            <h5 class="card-title cve-title">CVE-2021-36370</h5>
        </div>
        <div class="card-body pt-0">
            <div class="widget-49">
                <div class="widget-49-title-wrapper">
                    <div class="widget-49-date-primary">
                        <span class="widget-49-date-day">7.4</span>
                        <span class="widget-49-date-month">CVSS</span>
                    </div>
                    <div class="widget-49-meeting-info">
                        <span class="widget-49-pro-title"><b>Vector:</b> CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:H/A:N</span>
                        <span class="widget-49-meeting-time">
                            <a href="https://nvd.nist.gov/vuln/detail/CVE-2021-36370">https://nvd.nist.gov/vuln/detail/CVE-2021-36370</a>
                        </span>
                    </div>
                </div>
                <p class="widget-49-meeting-integration">
                    <i class="far fa-times-circle"></i> not integrated in SSH-MITM server
                </p>
                <p class="widget-49-meeting-text">
                The SFTP VFS in Midnight Commander from version 4.8.4 up to version 4.8.26 computes the fingerprints of remote hosts, but does not verify them.
                </p>
                <span class="widget-49-pro-title"><b>Affected Software:</b></span>
                <ul class="widget-49-meeting-points">
                    <li class="widget-49-meeting-item"><b>Midnight Commander</b> 4.8.4 - 4.8.26 </li>
                </ul>
            </div>
        </div>
    </div>

Release Announcement
--------------------

.. note::

    Hi there,

    I'm glad to announce the immediate availability of mc-4.8.27, a maintenance and security release, just in time before leaving all of you for a long overdue summer vacation!

    This release addresses an important security issue (CVE-2021-36370) in the SFTP VFS. Unfortunately, as the VFS was first introduced, the fingerprints of remote hosts were computed, but not verified, and the issue reported only now by Manfred KAISER from AUT-milCERT during an audit of open source software. We would like to thank the team at AUT-milCERT for finding the issue and responsibly disclosing it!

    ...

    - -- Sincerely yours,

    Yury V. Zaytsev


**Source:** https://mail.gnome.org/archives/mc-devel/2021-August/msg00008.html


Mitigation
----------

Update Midnight Commander to version >= 4.8.27


References
----------

* https://midnight-commander.org/wiki/NEWS-4.8.27
* https://mail.gnome.org/archives/mc-devel/2021-August/msg00008.html
* https://github.com/MidnightCommander/mc/blob/a88a626e76139259e5b6fc0db39045f051e243dd/src/vfs/sftpfs/connection.c#L479
