CVE-2021-36367
==============

.. raw:: html

    <div class="card card-margin">
        <div class="card-header no-border">
            <h5 class="card-title cve-title">CVE-2021-36367</h5>
        </div>
        <div class="card-body pt-0">
            <div class="widget-49">
                <div class="widget-49-title-wrapper">
                    <div class="widget-49-date-primary">
                        <span class="widget-49-date-day">8.1</span>
                        <span class="widget-49-date-month">CVSS</span>
                    </div>
                    <div class="widget-49-meeting-info">
                        <span class="widget-49-pro-title"><b>Vector:</b> CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:N</span>
                        <span class="widget-49-meeting-time">
                            <a href="https://nvd.nist.gov/vuln/detail/CVE-2021-36367">https://nvd.nist.gov/vuln/detail/CVE-2021-36367</a>
                        </span>
                    </div>
                </div>
                <p class="widget-49-meeting-integration">
                    <i class="fas fa-check"></i> integrated in <a href="https://docs.ssh-mitm.at/trivialauth.html">SSH-MITM server</a>
                </p>
                <p class="widget-49-meeting-text">
                    <b>Note: MITRE's description is wrong. Please read note bellow.</b></br>
                    PuTTY through 0.75 proceeds with establishing an SSH session even if it has never sent a substantive authentication response.
                    This makes it easier for an attacker-controlled SSH server to present a later spoofed authentication prompt
                    (that the attacker can use to capture credential data, and use that data for purposes that are undesired by the client user).
                </p>
                <span class="widget-49-pro-title"><b>Affected Software:</b></span>
                <ul class="widget-49-meeting-points">
                    <li class="widget-49-meeting-item"><b>PuTTY</b> &lt; 0.71</li>
                </ul>
            </div>
        </div>
    </div>

.. note::

    **Comment from Simon Tatham:**

    CVE-2021-36367 refers to this new option as a fix for a vulnerability, and describes the vulnerability
    as "PuTTY through 0.75 proceeds with establishing an SSH session even if it has never sent a substantive
    authentication response". With respect to the author of that text, we consider that to be misleading.
    It is perfectly legal for the server to waive authentication, and actually useful in some legitimate use cases;
    it is perfectly legal for PuTTY to proceed with the connection regardless; and the trust sigil system introduced
    in 0.71 already defends against every spoofing attack we know of that a server could attempt by doing this unexpectedly.
    This new option is a UI improvement, but not in and of itself a vital vulnerability fix.

PoC Exploit
-----------

The trivial authentication spoofing attack is described in :doc:`trivialauth`.


References
----------

* https://git.tartarus.org/?p=simon/putty.git;a=commit;h=1dc5659aa62848f0aeb5de7bd3839fecc7debefa
* https://www.chiark.greenend.org.uk/~sgtatham/putty/changes.html
