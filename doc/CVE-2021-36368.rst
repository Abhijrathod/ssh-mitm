CVE-2021-36368
==============

.. raw:: html

    <div class="card card-margin">
        <div class="card-header no-border">
            <h5 class="card-title cve-title">CVE-2021-36368</h5>
        </div>
        <div class="card-body pt-0">
            <div class="widget-49">
                <div class="widget-49-title-wrapper">
                    <div class="widget-49-date-primary">
                        <span class="widget-49-date-day">N/A</span>
                        <span class="widget-49-date-month">CVSS</span>
                    </div>
                    <div class="widget-49-meeting-info">
                        <span class="widget-49-pro-title"><b>Vector:</b> N/A</span>
                        <span class="widget-49-meeting-time">
                            <a href="https://nvd.nist.gov/vuln/detail/CVE-2021-36368">https://nvd.nist.gov/vuln/detail/CVE-2021-36368</a>
                        </span>
                    </div>
                </div>
                <p class="widget-49-meeting-integration">
                    <i class="fas fa-check"></i> integrated in <a href="https://docs.ssh-mitm.at/trivialauth.html">SSH-MITM server</a>
                </p>
                <p class="widget-49-meeting-text">
                    ** DISPUTED ** An issue was discovered in OpenSSH before 8.9. If a client is using public-key authentication with agent forwarding but without -oLogLevel=verbose, and an attacker has silently modified the server to support the None authentication option, then the user cannot determine whether FIDO authentication is going to confirm that the user wishes to connect to that server, or that the user wishes to allow that server to connect to a different server on the user's behalf. NOTE: the vendor's position is "this is not an authentication bypass, since nothing is being bypassed."
                </p>
                <span class="widget-49-pro-title"><b>Affected Software:</b></span>
                <ul class="widget-49-meeting-points">
                    <li class="widget-49-meeting-item"><b>OpenSSHH</b> &lt;= 8.8</li>
                </ul>
            </div>
        </div>
    </div>

PoC Exploit
-----------

The trivial authentication spoofing attack is described in :doc:`trivialauth`.


References
----------

* https://bugzilla.mindrot.org/show_bug.cgi?id=3316
* https://www.openssh.com/agent-restrict.html
* https://github.com/openssh/openssh-portable/pull/258
